!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=120)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LOG_INFO="LOG_INFO",e.LOG_ERROR="LOG_ERROR",e.LOG_WARN="LOG_WARN",e.EVENT_INTERNAL="EVENT_INTERNAL",e.EVENT_EXTERNAL_IN="EVENT_EXTERNAL_IN",e.EVENT_EXTERNAL_OUT="EVENT_EXTERNAL_OUT",e.EVENT_PORT_IN="EVENT_PORT_IN",e.EVENT_PORT_OUT="EVENT_PORT_OUT"}(t.ITEM_TYPE||(t.ITEM_TYPE={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.METADATA_KEY=i;var r=n(40);t.Container=r.Container;var o=n(6);t.BindingScopeEnum=o.BindingScopeEnum,t.BindingTypeEnum=o.BindingTypeEnum,t.TargetTypeEnum=o.TargetTypeEnum;var s=n(56);t.AsyncContainerModule=s.AsyncContainerModule,t.ContainerModule=s.ContainerModule;var a=n(57);t.injectable=a.injectable;var c=n(58);t.tagged=c.tagged;var u=n(59);t.named=u.named;var h=n(25);t.inject=h.inject,t.LazyServiceIdentifer=h.LazyServiceIdentifer;var d=n(60);t.optional=d.optional;var l=n(61);t.unmanaged=l.unmanaged;var f=n(62);t.multiInject=f.multiInject;var _=n(63);t.targetName=_.targetName;var p=n(64);t.postConstruct=p.postConstruct;var E=n(23);t.MetadataReader=E.MetadataReader;var v=n(10);t.id=v.id;var g=n(8);t.decorate=g.decorate;var O=n(28);t.traverseAncerstors=O.traverseAncerstors,t.taggedConstraint=O.taggedConstraint,t.namedConstraint=O.namedConstraint,t.typeConstraint=O.typeConstraint;var y=n(13);t.getServiceIdentifierAsString=y.getServiceIdentifierAsString;var T=n(65);t.multiBindToService=T.multiBindToService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===i.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={ALARM_SERVICE:Symbol.for("ALARM_SERVICE"),BROWSER:Symbol.for("BROWSER"),BROWSER_ACTION:Symbol.for("BROWSER_ACTION"),CACHE_SERVICE:Symbol.for("CACHE_SERVICE"),CONTAINER:Symbol.for("CONTAINER"),INTERNAL_DISPATCHER:Symbol.for("INTERNAL_DISPATCHER"),LOCAL_STORAGE_SERVICE:Symbol.for("LOCAL_STORAGE_SERVICE"),LOGGER_SERVICE:Symbol.for("LOGGER_SERVICE"),STORAGE_SERVICE:Symbol.for("STORAGE_SERVICE"),TAB_SERVICE:Symbol.for("TAB_SERVICE"),NAVIGATION_SERVICE:Symbol.for("NAVIGATION_SERVICE"),WEB_REQUEST_SERVICE:Symbol.for("WEB_REQUEST_SERVICE"),PROXY_SERVICE:Symbol.for("PROXY_SERVICE"),EXTENSION_SERVICE:Symbol.for("EXTENSION_SERVICE"),EXTERNAL_DISPATCHER:Symbol.for("EXTERNAL_DISPATCHER"),OMNIBOX_SERVICE:Symbol.for("OMNIBOX_SERVICE"),WINDOW_POST:Symbol.for("WINDOW_POST"),MANAGEMENT:Symbol.for("MANAGEMENT"),PORT_DISPATCHER:Symbol.for("PORT_DISPATCHER")};t.MARIO_TYPES=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(38);t.Mario=i.Mario;var r=n(76);t.MarioModule=r.MarioModule;var o=n(33);t.MarioEvent=o.MarioEvent;var s=n(5);t.MARIO_TYPES=s.MARIO_TYPES;var a=n(32);t.ExternalDispatcher=a.ExternalDispatcher;var c=n(78);t.CacheService=c.CacheService;var u=n(80);t.ContentDispatcherService=u.ContentDispatcherService;var h=n(29);t.InternalDispatcher=h.InternalDispatcher;var d=n(30);t.LoggerService=d.LoggerService;var l=n(31);t.TabService=l.TabService;var f=n(81);t.NavigationService=f.NavigationService;var _=n(83);t.WebRequestService=_.WebRequestService;var p=n(85);t.StorageService=p.StorageService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(1);function o(e,t,n,r,o){var s={},a="number"==typeof o,c=void 0!==o&&a?o.toString():n;if(a&&void 0!==n)throw new Error(i.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(s=Reflect.getMetadata(e,t));var u=s[c];if(Array.isArray(u))for(var h=0,d=u;h<d.length;h++){var l=d[h];if(l.key===r.key)throw new Error(i.DUPLICATED_METADATA+" "+l.key.toString())}else u=[];u.push(r),s[c]=u,Reflect.defineMetadata(e,s,t)}function s(e,t){Reflect.decorate(e,t)}function a(e,t){return function(n,i){t(n,i,e)}}t.tagParameter=function(e,t,n,i){o(r.TAGGED,e,t,i,n)},t.tagProperty=function(e,t,n){o(r.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"==typeof n?s([a(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):s([e],t)}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0;t.id=function(){return i++}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MARIO_DEVTOOLS_LOGGER_INFO="MARIO_DEVTOOLS_LOGGER_INFO",e.MARIO_DEVTOOLS_LOGGER_WARN="MARIO_DEVTOOLS_LOGGER_WARN",e.MARIO_DEVTOOLS_LOGGER_ERROR="MARIO_DEVTOOLS_LOGGER_ERROR",e.MARIO_DEVTOOLS_EXTERNAL_IN_EVENT="MARIO_DEVTOOLS_EXTERNAL_IN_EVENT",e.MARIO_DEVTOOLS_EXTERNAL_OUT_EVENT="MARIO_DEVTOOLS_EXTERNAL_OUT_EVENT",e.MARIO_DEVTOOLS_INTERNAL_EVENT="MARIO_DEVTOOLS_INTERNAL_EVENT",e.MARIO_DEVTOOLS_PORT_IN_EVENT="MARIO_DEVTOOLS_PORT_IN_EVENT",e.MARIO_DEVTOOLS_PORT_OUT_EVENT="MARIO_DEVTOOLS_PORT_OUT_EVENT"}(t.DevtoolsEvents||(t.DevtoolsEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);function r(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function o(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=r,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=o(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(function e(t,n){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===n||e(t.parentRequest,n))}(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var i=r(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(i.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=o},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(17),r=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new i.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),r=n(28),o=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=r.namedConstraint(e),new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new i.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=r.taggedConstraint(e)(t),new i.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return r.typeConstraint(e)(t.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return r.namedConstraint(e)(t.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return r.taggedConstraint(e)(t)(n.parentRequest)},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.typeConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.typeConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,r.namedConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,r.namedConstraint(e))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return r.traverseAncerstors(n,r.taggedConstraint(e)(t))},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!r.traverseAncerstors(n,r.taggedConstraint(e)(t))},new i.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return r.traverseAncerstors(t,e)},new i.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!r.traverseAncerstors(t,e)},new i.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i={DEV_TOOLS_EMITTER_SERVICE:Symbol.for("DEV_TOOLS_EMITTER_SERVICE"),DEV_TOOLS_STATE:Symbol.for("DEV_TOOLS_STATE"),DEV_TOOLS_STORAGE:Symbol.for("DEV_TOOLS_STORAGE")};t.DevToolsTypes=i},,function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),a=n(7),c=n(5),u=n(36);let h=class{constructor(e,t,n){this.container=e,this.logger=t,this.dispatcher=n,this.ports={},this.listeners={},this.onBeforeEmitListeners=[],chrome.runtime.onConnect.addListener(e=>{this.ports[e.name]=e,this.logger.log(`Port "${e.name}" is created`),e.onMessage.addListener(t=>{if(t.port=e.name,this.internalEmit(u.PortDispatcherEvents.ON_ANY_MESSAGE,t),this.isEventMessage(t)){const e=t.event;this.internalEmit(e,t)}}),e.onDisconnect.addListener(()=>{this.logger.log(`Port "${e.name}" is disconnected`),delete this.ports[e.name];const t=new a.MarioEvent(u.PortDispatcherEvents.PORT_DISCONNECTED,{name:e.name});this.dispatcher.emit(t).then()});const t=new a.MarioEvent(u.PortDispatcherEvents.PORT_CONNECTED,{name:e.name});this.dispatcher.emit(t).then()})}on(e){this.container.bind(e).toSelf().inSingletonScope();const t=this.container.get(e),n=t.on();void 0===this.listeners[n]&&(this.listeners[n]=[]),this.listeners[n].push(t),this.logger.log(`PortDispatcher: register a listener on event "${n}"`)}onBeforeEmit(e){this.onBeforeEmitListeners.push(e)}emit(e,t,n){let i=[];if(t){const e=t;if(this.hasNotPort(e))throw Error(`PortDispatcher: a named port "${e}" is not found`);const n=this.getPort(e);i.push(n)}else i=Object.keys(this.ports).map(e=>this.ports[e]);!n&&this.onBeforeEmitListeners.forEach(t=>{try{t(e)}catch(e){this.logger.error(e)}}),i.forEach(t=>t.postMessage(e))}hasPort(e){return!!this.ports[e]}hasNotPort(e){return!this.hasPort(e)}disconnectPort(e){this.hasNotPort(e)&&this.logger.log(`Port "${e}" cannot be disconnected because it's not registered`);this.ports[e].disconnect()}hasEventListeners(e){return this.listeners[e]&&this.listeners[e].length>0}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}getPort(e){return this.ports[e]}internalEmit(e,t){this.hasEventListeners(e)&&this.listeners[e].forEach(e=>{try{e.handle(t).then()}catch(e){this.logger.error(e)}})}};h=i([s.injectable(),o(0,s.inject(c.MARIO_TYPES.CONTAINER)),o(1,s.inject(c.MARIO_TYPES.LOGGER_SERVICE)),o(2,s.inject(c.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object,Object])],h),t.PortDispatcher=h},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);let o=class{constructor(){this.ready=!1}isReady(){return this.ready}isNotReady(){return!this.isReady()}setReady(){this.ready=!0}};o=i([r.injectable()],o),t.DevToolsState=o},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(i.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(i.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(i.TAGGED_PROP,e)||[]},e}();t.MetadataReader=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===i.STACK_OVERFLOW}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(1),o=n(4),s=n(8),a=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=a,t.inject=function(e){return function(t,n,a){if(void 0===e)throw new Error(i.UNDEFINED_INJECT_ANNOTATION(t.name));var c=new o.Metadata(r.INJECT_TAG,e);"number"==typeof a?s.tagParameter(t,n,a,c):s.tagProperty(t,n,c)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(10),o=n(4),s=n(47),a=function(){function e(e,t,n,a){this.id=r.id(),this.type=e,this.serviceIdentifier=n,this.name=new s.QueryableString(t||""),this.metadata=new Array;var c=null;"string"==typeof a?c=new o.Metadata(i.NAMED_TAG,a):a instanceof o.Metadata&&(c=a),null!==c&&this.metadata.push(c)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(i.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(i.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(i.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==i.INJECT_TAG&&e.key!==i.MULTI_INJECT_TAG&&e.key!==i.NAME_TAG&&e.key!==i.UNMANAGED_TAG&&e.key!==i.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(i.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===i.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==i.INJECT_TAG&&e.key!==i.MULTI_INJECT_TAG&&e.key!==i.NAME_TAG&&e.key!==i.UNMANAGED_TAG&&e.key!==i.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(i.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}();t.Target=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),r=n(17),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new r.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||o(n,t))};t.traverseAncerstors=o;var s=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new r.Metadata(e,t),n}};t.taggedConstraint=s;var a=s(i.NAMED_TAG);t.namedConstraint=a;t.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(5),u=n(66);let h=class{constructor(e,t){this.container=e,this.loggerService=t,this.counter=0,this.listeners={},this.listenersIndex={},this.onBeforeEmitListeners=[]}emit(e){return s(this,void 0,void 0,(function*(){this.loggerService.event("InternalDispatcher",e);try{this.onBeforeEmitListeners.forEach(t=>t(e))}catch(e){this.loggerService.error(e)}const t=this.getEventListeners(e.event),n=[];for(const i in t){const r=t[i],o=r.handle.apply(r,[e]);n.push(o)}Promise.all(n).then()}))}on(e){this.container.bind(e).toSelf().inSingletonScope();const t=this.container.get(e),n=t.on();this.loggerService.log(`InternalDispatcher: register a listener on event "${n}"`),void 0===this.listeners[n]&&(this.listeners[n]=[]);const i=++this.counter;return this.listenersIndex[i]=n,this.listeners[n][i]=t,i}onBeforeEmit(e){this.onBeforeEmitListeners.push(e)}hasEventListeners(e){return this.listeners.hasOwnProperty(e)&&this.listeners[e].length>0}getEventListeners(e){if(this.hasEventListeners(e)){return this.listeners[e].filter(e=>!!e.handle)}return[]}getListener(e){if(!this.hasListener(e))throw new u.InternalDispatcherListenerIsNotRegisteredException(`a listener with id "${e}" is not registered`);const t=this.listenersIndex[e];return this.listeners[t][e]}removeListener(e){if(!this.hasListener(e))throw new u.InternalDispatcherListenerIsNotRegisteredException(`a listener with id "${e}" is not registered`);const t=this.listenersIndex[e];delete this.listenersIndex[e],delete this.listeners[t][e]}hasListener(e){return this.listenersIndex.hasOwnProperty(e)}};h=i([a.injectable(),o(0,a.inject(c.MARIO_TYPES.CONTAINER)),o(1,a.inject(c.MARIO_TYPES.LOGGER_SERVICE)),r("design:paramtypes",[Object,Object])],h),t.InternalDispatcher=h},function(e,t,n){"use strict";var i,r=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2),s=n(68);let a=i=class{constructor(){this.onLogListeners=[],this.onEventListeners=[],this.onErrorListeners=[],this.onWarnListeners=[],this.onFilterLogListeners=[],this.enabled=!0}log(e,t){const n=this.time();n[0]+="%c[INFO] %c"+e,n.push(this.color(i.LIGHT_BLUE_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR));let r="";void 0!==t&&(r=s(t,null,2));const o=this.prepareOutput(n[0],r);!this.filterInfo(o)&&(this.enabled&&console.log.apply(console,n),this.enabled&&r&&console.log(r)),this.handleOnLogListeners(e,t,o)}event(e,t){const n=this.time();n[0]+=`%c[EVENT ${t.event}] %c${e}`,n.push(this.color(i.LIGHT_GREEN_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR)),this.enabled&&console.log.apply(console,n);const r=s(t.data,null,2);this.enabled&&console.log(r),this.handleOnEventListeners(e,t,this.prepareOutput(n[0],r))}warn(e,t){const n=this.time();n[0]+="%c[WARN] %c"+e,n.push(this.color(i.RED_COLOR)+this.fontWeight(600)),n.push(this.color(i.BLACK_COLOR)),this.enabled&&console.log.apply(console,n);let r="";this.enabled&&void 0!==t&&(console.log(t),r=s(t,null,2)),this.handleOnWarnListeners(e,t,this.prepareOutput(n[0],r))}error(e){const t=this.time();t[0]+="%c[ERROR] %c"+e.message,t.push(this.color(i.RED_COLOR)+this.fontWeight(600)),t.push(this.color(i.BLACK_COLOR)),this.enabled&&(console.log.apply(console,t),console.error(e.stack)),this.handleOnErrorListeners(e)}onLog(e){this.onLogListeners.push(e)}onEvent(e){this.onEventListeners.push(e)}onWarn(e){this.onWarnListeners.push(e)}onError(e){this.onErrorListeners.push(e)}onFilterLog(e){this.onFilterLogListeners.push(e)}disable(){this.enabled=!1}enable(){this.enabled=!0}handleOnLogListeners(e,t,n){for(const i of this.onLogListeners)i(e,t,n)}handleOnWarnListeners(e,t,n){for(const i of this.onWarnListeners)i(e,t,n)}handleOnEventListeners(e,t,n){for(const i of this.onEventListeners)i(e,t,n)}handleOnErrorListeners(e,t){for(const n of this.onErrorListeners)n(e,t)}filterInfo(e){for(const t of this.onFilterLogListeners){if(t(e))return!0}return!1}time(){const e=new Date;let t="%c[";return t+=`tz:${e.getTimezoneOffset()} `,t+=this.pad(e.getDate().toString(),2)+"/",t+=this.pad(e.getMonth().toString(),2)+"/",t+=e.getFullYear()+" ",t+=this.pad(e.getHours().toString(),2)+":",t+=this.pad(e.getMinutes().toString(),2)+":",t+=this.pad(e.getSeconds().toString(),2)+" ",t+=""+this.pad(e.getMilliseconds().toString(),4),t+="]%c ",[t,this.fontWeight(600),this.color(i.BLACK_COLOR)]}color(e){return`color: ${e};`}fontWeight(e){return`font-weight: ${e};`}pad(e,t,n){const i=n||"0";return e.length>=t?e:new Array(t-e.length+1).join(i)+e}prepareOutput(e,t){return`${e.replace(/%c/g,"")}\n${t}`}};a.BLACK_COLOR="#000",a.RED_COLOR="#f40f3f",a.LIGHT_GREEN_COLOR="#1e9f3e",a.LIGHT_BLUE_COLOR="#4285f4",a=i=r([o.injectable()],a),t.LoggerService=a},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(7),u=n(5),h=n(69);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnCreated=!1,this.isListenOnUpdated=!1,this.isListenOnMoved=!1,this.isListenOnActivated=!1,this.isListenOnHighlighted=!1,this.isListenOnDetached=!1,this.isListenOnAttached=!1,this.isListenOnRemoved=!1,this.isListenOnReplaced=!1,this.isListenOnZoomChange=!1}listenOnCreated(){this.isListenOnCreated||(this.isListenOnCreated=!0,chrome.tabs.onCreated.addListener(e=>{const t=new c.MarioEvent(h.TabServiceEvents.ON_TAB_CREATED,{tab:e});this.dispatcherService.emit(t).then()}))}listenOnUpdated(){this.isListenOnUpdated||(this.isListenOnUpdated=!0,chrome.tabs.onUpdated.addListener((e,t,n)=>{const i=new c.MarioEvent(h.TabServiceEvents.ON_TAB_UPDATED,{tabId:e,changeInfo:t,tab:n});this.dispatcherService.emit(i).then()}))}listenOnMoved(){this.isListenOnMoved||(this.isListenOnMoved=!0,chrome.tabs.onMoved.addListener((e,t)=>{const n=new c.MarioEvent(h.TabServiceEvents.ON_TAB_MOVED,{tabId:e,moveInfo:t});this.dispatcherService.emit(n).then()}))}listenOnActivated(){this.isListenOnActivated||(this.isListenOnActivated=!0,chrome.tabs.onActivated.addListener(e=>{const t=new c.MarioEvent(h.TabServiceEvents.ON_TAB_ACTIVATED,{activeInfo:e});this.dispatcherService.emit(t).then()}))}listenOnHighlighted(){this.isListenOnHighlighted||(this.isListenOnHighlighted=!0,chrome.tabs.onHighlighted.addListener(e=>{const t=new c.MarioEvent(h.TabServiceEvents.ON_TAB_HIGHLIGHTED,{highlightInfo:e});this.dispatcherService.emit(t).then()}))}listenOnDetached(){this.isListenOnDetached||(this.isListenOnDetached=!0,chrome.tabs.onDetached.addListener((e,t)=>{const n=new c.MarioEvent(h.TabServiceEvents.ON_TAB_DETACHED,{tabId:e,detachInfo:t});this.dispatcherService.emit(n).then()}))}listenOnAttached(){this.isListenOnAttached||(this.isListenOnAttached=!0,chrome.tabs.onAttached.addListener((e,t)=>{const n=new c.MarioEvent(h.TabServiceEvents.ON_TAB_ATTACHED,{tabId:e,attachInfo:t});this.dispatcherService.emit(n).then()}))}listenOnRemoved(){this.isListenOnRemoved||(this.isListenOnRemoved=!0,chrome.tabs.onRemoved.addListener((e,t)=>{const n=new c.MarioEvent(h.TabServiceEvents.ON_TAB_REMOVED,{tabId:e,removeInfo:t});this.dispatcherService.emit(n).then()}))}listenOnReplaced(){this.isListenOnReplaced||(this.isListenOnReplaced=!0,chrome.tabs.onReplaced.addListener((e,t)=>{const n=new c.MarioEvent(h.TabServiceEvents.ON_TAB_REPLACED,{addedTabId:e,removedTabId:t});this.dispatcherService.emit(n).then()}))}listenOnZoomChange(){this.isListenOnZoomChange||(this.isListenOnZoomChange=!0,chrome.tabs.onZoomChange.addListener(e=>{const t=new c.MarioEvent(h.TabServiceEvents.ON_TAB_ZOOM_CHANGE,{zoomChangeInfo:e});this.dispatcherService.emit(t).then()}))}sendMessage(e,t){chrome.tabs.sendMessage(e,t,e=>{chrome.runtime.lastError})}query(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.tabs.query(e,e=>{t(e)})}catch(e){n()}})}))}reload(e,t={}){return s(this,void 0,void 0,(function*(){return new Promise((n,i)=>{try{chrome.tabs.reload(e,t,()=>{n()})}catch(e){i()}})}))}create(e){chrome.tabs.create(e)}get(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.tabs.get(e,e=>t(e))}catch(e){n(e)}})}))}getCurrent(){return s(this,void 0,void 0,(function*(){return new Promise((e,t)=>{try{chrome.tabs.getCurrent(t=>e(t))}catch(e){t(e)}})}))}duplicate(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.tabs.duplicate(e,e=>t(e))}catch(e){n(e)}})}))}highlight(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.tabs.highlight(e,()=>t())}catch(e){n(e)}})}))}update(e,t){return s(this,void 0,void 0,(function*(){return new Promise((n,i)=>{try{chrome.tabs.update(t,e,e=>n(e))}catch(e){i(e)}})}))}move(e,t){return s(this,void 0,void 0,(function*(){return new Promise((n,i)=>{try{chrome.tabs.move(e,t,e=>n(e))}catch(e){i(e)}})}))}remove(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.tabs.remove(e,e=>t(e))}catch(e){n(e)}})}))}};d=i([a.injectable(),o(0,a.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.TabService=d},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),a=n(5),c=n(35),u=n(74);let h=class{constructor(e,t,n){this.container=e,this.loggerService=t,this.tabService=n,this.listeners={},this.listenersIndex={},this.counter=0,this.beforeEmitListeners=[],chrome.runtime.onMessage.addListener((e,t,n)=>{if(this.internalEmit(c.ExternalDispatcherEvents.ON_ANY_MESSAGE,e,t,n),this.isEventMessage(e)){const i=e.event;this.loggerService.event("ExternalDispatcher: got",e),this.internalEmit(i,e,t,n)}return!0})}emit(e,t){this.loggerService.event("ExternalDispatcher: emit",t);try{this.beforeEmitListeners.forEach(n=>n(e,t))}catch(e){this.loggerService.error(e)}this.tabService.sendMessage(e,t)}on(e){const t=this.bind(e);return this.loggerService.log(`ExternalDispatcher: register an event listener "${t.on()}"`),this.addEventListener(t.on(),t)}onBeforeEmit(e){this.beforeEmitListeners.push(e)}removeListener(e){if(!this.hasListeners(e))throw new u.ExternalDispatcherListenerIsNotFoundException(`Listener with id "${e}" is not found`);this.loggerService.log(`ExternalDispatcher: remove an event listener "${e}"`);const t=this.listenersIndex[e];delete this.listeners[t][e],delete this.listenersIndex[e]}getListener(e){if(!this.hasListeners(e))throw new u.ExternalDispatcherListenerIsNotFoundException(`Listener with id "${e}" is not found`);const t=this.listenersIndex[e];return this.listeners[t][e]}hasListeners(e){return void 0!==this.listenersIndex[e]}getEventListeners(e){return this.hasEventListeners(e)?this.listeners[e]:[]}hasEventListeners(e){return void 0!==this.listeners[e]}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}internalEmit(e,t,n,i){if(!this.hasEventListeners(e))return;const r=[],o=this.listeners[e];for(const e of Object.keys(o)){const s=o[e],a=s.handle.apply(s,[t,n,i]);r.push(a)}Promise.all(r).then()}addEventListener(e,t){void 0===this.listeners[e]&&(this.listeners[e]={});const n=++this.counter;return this.listeners[e][n]=t,this.listenersIndex[n]=e,n}bind(e){return this.container.bind(e).toSelf().inSingletonScope(),this.container.get(e)}};h=i([s.injectable(),o(0,s.inject(a.MARIO_TYPES.CONTAINER)),o(1,s.inject(a.MARIO_TYPES.LOGGER_SERVICE)),o(2,s.inject(a.MARIO_TYPES.TAB_SERVICE)),r("design:paramtypes",[Object,Object,Object])],h),t.ExternalDispatcher=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(77);t.MarioEvent=class{constructor(e,t,n){this.event=e,this.data=t,this.id=n||i.Guid.create().toString()}}},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c,u=[],h=!1,d=-1;function l(){h&&c&&(h=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!h){var e=a(l);h=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new _(e,t)),1!==u.length||h||a(f)},_.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ON_ANY_MESSAGE="ON_ANY_MESSAGE"}(t.ExternalDispatcherEvents||(t.ExternalDispatcherEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.PORT_CONNECTED="PORT_CONNECTED",e.PORT_DISCONNECTED="PORT_DISCONNECTED",e.ON_ANY_MESSAGE="ON_ANY_MESSAGE"}(t.PortDispatcherEvents||(t.PortDispatcherEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MARIO_DEVTOOLS="MARIO_DEVTOOLS"}(t.PortsList||(t.PortsList={}))},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),n(39);const r=n(2),o=n(29),s=n(30),a=n(31),c=n(70),u=n(72),h=n(5),d=n(32),l=n(20);t.Mario=class{constructor(t,n={}){this.isInitialized=!1,this._container=n.container?n.container:new r.Container,this._container.bind(h.MARIO_TYPES.BROWSER).toConstantValue(t),this._container.bind(h.MARIO_TYPES.CONTAINER).toConstantValue(this._container);const i=n.logger?n.logger:s.LoggerService,c=n.internalDispatcher?n.internalDispatcher:o.InternalDispatcher,f=n.externalDispatcher?n.externalDispatcher:d.ExternalDispatcher,_=n.tab?n.tab:a.TabService;this.registerService(h.MARIO_TYPES.LOGGER_SERVICE,i),this.logger().log(`Core: this build is for "${t.toString()}"`),this.registerService(h.MARIO_TYPES.EXTENSION_SERVICE,u.Extension),this.extension(),this.registerService(h.MARIO_TYPES.INTERNAL_DISPATCHER,c),this.registerService(h.MARIO_TYPES.EXTERNAL_DISPATCHER,f),this.registerService(h.MARIO_TYPES.PORT_DISPATCHER,l.PortDispatcher),this.registerService(h.MARIO_TYPES.TAB_SERVICE,_),this.getService(h.MARIO_TYPES.PORT_DISPATCHER);e.window.mario=this,this.coreInitialized()}registerModule(e,t){return i(this,void 0,void 0,(function*(){const n=new e(this);this.logger().log(`Core: registering a module "${n.name()}"`);try{yield n.register(t),this.logger().log(`Core: the module "${n.name()}" is registered`)}catch(e){this.logger().error(e)}}))}registerService(e,t){this.isCoreInitialized()&&this.logger().log(`Core: registered a service "${e.toString()}"`),this.hasService(e)||this._container.bind(e).to(t).inSingletonScope()}getService(e){if(!this.hasService(e)){const t=`Can't get service: service '${e.toString()}' is not registered`;throw this.isCoreInitialized()&&this.logger().warn(t),new c.CoreServiceIsNotRegisteredException(t)}return this._container.get(e)}hasService(e){return this._container.isBound(e)}internalDispatcher(){return this.getService(h.MARIO_TYPES.INTERNAL_DISPATCHER)}externalDispatcher(){return this.getService(h.MARIO_TYPES.EXTERNAL_DISPATCHER)}portDispatcher(){return this.getService(h.MARIO_TYPES.PORT_DISPATCHER)}logger(){return this.getService(h.MARIO_TYPES.LOGGER_SERVICE)}container(){return this._container}tabService(){return this.getService(h.MARIO_TYPES.TAB_SERVICE)}extension(){return this.getService(h.MARIO_TYPES.EXTENSION_SERVICE)}coreInitialized(){this.isInitialized=!0}isCoreInitialized(){return this.isInitialized}}}).call(this,n(9))},function(e,t,n){(function(e,t){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n;!function(n){!function(i){var r="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),o=s(n);function s(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===r.Reflect?r.Reflect=n:o=s(r.Reflect,o),function(t){var n=Object.prototype.hasOwnProperty,i="function"==typeof Symbol,r=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=i&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,a={__proto__:[]}instanceof Array,c=!s&&!a,u={create:s?function(){return D(Object.create(null))}:a?function(){return D({__proto__:null})}:function(){return D({})},has:c?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},h=Object.getPrototypeOf(Function),d="object"==typeof e&&e.env&&"true"===e.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[o]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,r)},t.prototype.entries=function(){return new n(this._keys,this._values,s)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[o]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function r(e,t){return t}function s(e,t){return[e,t]}}():Map,f=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new l}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[o]=function(){return this.keys()},e}():Set,_=new(d||"function"!=typeof WeakMap?function(){var e=u.create(),t=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=r(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=r(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return r(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=r(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var t;do{t="@@WeakMap@@"+s()}while(u.has(e,t));return e[t]=!0,t}function r(e,i){if(!n.call(e,t)){if(!i)return;Object.defineProperty(e,t,{value:u.create()})}return e[t]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(){var e,t=(e=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<16;++i){var r=t[i];4!==i&&6!==i&&8!==i||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}():WeakMap);function p(e,t,n){var i=_.get(e);if(T(i)){if(!n)return;i=new l,_.set(e,i)}var r=i.get(t);if(T(r)){if(!n)return;r=new l,i.set(t,r)}return r}function E(e,t,n){var i=p(t,n,!1);return!T(i)&&!!i.has(e)}function v(e,t,n){var i=p(t,n,!1);if(!T(i))return i.get(e)}function g(e,t,n,i){p(n,i,!0).set(e,t)}function O(e,t){var n=[],i=p(e,t,!1);if(T(i))return n;for(var r=function(e){var t=w(e,o);if(!N(t))throw new TypeError;var n=t.call(e);if(!A(n))throw new TypeError;return n}(i.keys()),s=0;;){var a=L(r);if(!a)return n.length=s,n;var c=a.value;try{n[s]=c}catch(e){try{C(r)}finally{throw e}}s++}}function y(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function T(e){return void 0===e}function R(e){return null===e}function A(e){return"object"==typeof e?null!==e:"function"==typeof e}function S(e,t){switch(y(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=w(e,r);if(void 0!==i){var o=i.call(e,n);if(A(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(N(n))if(!A(r=n.call(e)))return r;if(N(i=e.valueOf))if(!A(r=i.call(e)))return r}else{var i;if(N(i=e.valueOf))if(!A(r=i.call(e)))return r;var r,o=e.toString;if(N(o))if(!A(r=o.call(e)))return r}throw new TypeError}(e,"default"===n?"number":n)}function m(e){var t=S(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function b(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function N(e){return"function"==typeof e}function I(e){return"function"==typeof e}function w(e,t){var n=e[t];if(null!=n){if(!N(n))throw new TypeError;return n}}function L(e){var t=e.next();return!t.done&&t}function C(e){var t=e.return;t&&t.call(e)}function M(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===h)return t;if(t!==h)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function D(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,n,i){if(T(n)){if(!b(e))throw new TypeError;if(!I(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!T(i)&&!R(i)){if(!I(i))throw new TypeError;t=i}}return t}(e,t)}if(!b(e))throw new TypeError;if(!A(t))throw new TypeError;if(!A(i)&&!T(i)&&!R(i))throw new TypeError;return R(i)&&(i=void 0),function(e,t,n,i){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,n,i);if(!T(o)&&!R(o)){if(!A(o))throw new TypeError;i=o}}return i}(e,t,n=m(n),i)})),t("metadata",(function(e,t){return function(n,i){if(!A(n))throw new TypeError;if(!T(i)&&!function(e){switch(y(e)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;g(e,t,n,i)}})),t("defineMetadata",(function(e,t,n,i){if(!A(n))throw new TypeError;return T(i)||(i=m(i)),g(e,t,n,i)})),t("hasMetadata",(function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=m(n)),function e(t,n,i){if(E(t,n,i))return!0;var r=M(n);return!R(r)&&e(t,r,i)}(e,t,n)})),t("hasOwnMetadata",(function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=m(n)),E(e,t,n)})),t("getMetadata",(function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=m(n)),function e(t,n,i){if(E(t,n,i))return v(t,n,i);var r=M(n);return R(r)?void 0:e(t,r,i)}(e,t,n)})),t("getOwnMetadata",(function(e,t,n){if(!A(t))throw new TypeError;return T(n)||(n=m(n)),v(e,t,n)})),t("getMetadataKeys",(function(e,t){if(!A(e))throw new TypeError;return T(t)||(t=m(t)),function e(t,n){var i=O(t,n),r=M(t);if(null===r)return i;var o=e(r,n);if(o.length<=0)return i;if(i.length<=0)return o;for(var s=new f,a=[],c=0,u=i;c<u.length;c++){var h=u[c];s.has(h)||(s.add(h),a.push(h))}for(var d=0,l=o;d<l.length;d++){h=l[d];s.has(h)||(s.add(h),a.push(h))}return a}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!A(e))throw new TypeError;return T(t)||(t=m(t)),O(e,t)})),t("deleteMetadata",(function(e,t,n){if(!A(t))throw new TypeError;T(n)||(n=m(n));var i=p(t,n,!1);if(T(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=_.get(t);return r.delete(n),r.size>0||_.delete(t),!0}))}(o)}()}(n||(n={}))}).call(this,n(34),n(9))},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(s,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[0,r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(41),s=n(3),a=n(6),c=n(1),u=n(23),h=n(42),d=n(49),l=n(51),f=n(10),_=n(13),p=n(54),E=n(55),v=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=a.BindingScopeEnum.Transient;else if(t.defaultScope!==a.BindingScopeEnum.Singleton&&t.defaultScope!==a.BindingScopeEnum.Transient&&t.defaultScope!==a.BindingScopeEnum.Request)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=f.id(),this._bindingDictionary=new E.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new u.MetadataReader}return e.merge=function(t,n){var i=new e,r=h.getBindingDictionary(i),o=h.getBindingDictionary(t),s=h.getBindingDictionary(n);function a(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return a(o,r),a(s,r),i},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],s=n(o.id);o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(this,void 0,void 0,(function(){var t,n,i,o,s;return r(this,(function(r){switch(r.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,r.label=1;case 1:return n<i.length?(o=i[n],s=t(o.id),[4,o.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction)]):[3,4];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=i(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||a.BindingScopeEnum.Transient,n=new o.Binding(e,t);return this._bindingDictionary.add(e,n),new l.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(s.CANNOT_UNBIND+" "+_.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new E.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,c.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=h.createMockRequest(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(p.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,a.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,a.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,c.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,a.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,a.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,c.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind.bind(e)(i);return t(r,n),r}};return function(i){return{bindFunction:(r=i,function(n){var i=e.bind.bind(e)(n);return t(i,r),i}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(i),unbindFunction:function(t){e.unbind.bind(e)(t)}};var r}},e.prototype._get=function(e,t,n,i,r,o){var a=null,c={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:r,serviceIdentifier:i,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(c)))throw new Error(s.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(c);return a},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=h.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),d.resolve(n)}},e}();t.Container=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(10),o=function(){function e(e,t){this.id=r.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=i.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(43),r=n(3),o=n(6),s=n(1),a=n(24),c=n(13),u=n(44),h=n(4),d=n(45),l=n(46),f=n(48),_=n(26);function p(e){return e._bindingDictionary}function E(e,t,n,o,s){var a=v(n.container,s.serviceIdentifier),u=[];return a.length===i.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof s.serviceIdentifier&&e.getConstructorMetadata(s.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(s.serviceIdentifier).toSelf(),a=v(n.container,s.serviceIdentifier)),u=t?a:a.filter((function(e){var t=new f.Request(e.serviceIdentifier,n,o,e,s);return e.constraint(t)})),function(e,t,n,o){switch(t.length){case i.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var s=c.getServiceIdentifierAsString(e),a=r.NOT_REGISTERED;throw a+=c.listMetadataForTarget(s,n),a+=c.listRegisteredBindingsForServiceIdentifier(o,s,v),new Error(a);case i.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case i.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;s=c.getServiceIdentifierAsString(e),a=r.AMBIGUOUS_MATCH+" "+s;throw a+=c.listRegisteredBindingsForServiceIdentifier(o,s,v),new Error(a)}}(s.serviceIdentifier,u,s,n.container),u}function v(e,t){var n=[],i=p(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=v(e.parent,t)),n}t.getBindingDictionary=p,t.plan=function(e,t,n,i,p,v,g,O){void 0===O&&(O=!1);var y=new u.Context(t),T=function(e,t,n,i,r,o){var a=e?s.MULTI_INJECT_TAG:s.INJECT_TAG,c=new h.Metadata(a,n),u=new _.Target(t,i,n,c);if(void 0!==r){var d=new h.Metadata(r,o);u.metadata.push(d)}return u}(n,i,p,"",v,g);try{return function e(t,n,i,s,a,c){var u,h;if(null===a){u=E(t,n,s,null,c),h=new f.Request(i,s,null,u,c);var _=new d.Plan(s,h);s.addPlan(_)}else u=E(t,n,s,a,c),h=a.addChildRequest(c.serviceIdentifier,u,c);u.forEach((function(n){var i=null;if(c.isArray())i=h.addChildRequest(n.serviceIdentifier,n,c);else{if(n.cache)return;i=h}if(n.type===o.BindingTypeEnum.Instance&&null!==n.implementationType){var a=l.getDependencies(t,n.implementationType);if(!s.container.options.skipBaseClassChecks){var u=l.getBaseClassDependencyCount(t,n.implementationType);if(a.length<u){var d=r.ARGUMENTS_LENGTH_MISMATCH(l.getFunctionName(n.implementationType));throw new Error(d)}}a.forEach((function(n){e(t,!1,n.serviceIdentifier,s,i,n)}))}}))}(e,O,p,y,null,T),y}catch(e){throw a.isStackOverflowExeption(e)&&y.plan&&c.circularDependencyToException(y.plan.rootRequest),e}},t.createMockRequest=function(e,t,n,i){var r=new _.Target(o.TargetTypeEnum.Variable,"",t,new h.Metadata(n,i)),s=new u.Context(e);return new f.Request(t,s,null,[],r)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),r=function(){function e(e){this.id=i.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(25),r=n(3),o=n(6),s=n(1),a=n(13);t.getFunctionName=a.getFunctionName;var c=n(26);function u(e,t,n,i){var s=e.getConstructorMetadata(n),a=s.compilerGeneratedMetadata;if(void 0===a){var u=r.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(u)}var l=s.userGeneratedMetadata,f=Object.keys(l),_=function(e,t,n,i,r){for(var o=[],s=0;s<r;s++){var a=h(s,e,t,n,i);null!==a&&o.push(a)}return o}(i,t,a,l,0===n.length&&f.length>0?f.length:n.length),p=function e(t,n){for(var i=t.getPropertiesMetadata(n),r=[],s=Object.keys(i),a=0,u=s;a<u.length;a++){var h=u[a],l=i[h],f=d(i[h]),_=f.targetName||h,p=f.inject||f.multiInject,E=new c.Target(o.TargetTypeEnum.ClassProperty,_,p);E.metadata=l,r.push(E)}var v=Object.getPrototypeOf(n.prototype).constructor;if(v!==Object){var g=e(t,v);r=r.concat(g)}return r}(e,n);return _.concat(p)}function h(e,t,n,s,a){var u=a[e.toString()]||[],h=d(u),l=!0!==h.unmanaged,f=s[e],_=h.inject||h.multiInject;if((f=_||f)instanceof i.LazyServiceIdentifer&&(f=f.unwrap()),l){if(!t&&(f===Object||f===Function||void 0===f)){var p=r.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(p)}var E=new c.Target(o.TargetTypeEnum.ConstructorArgument,h.targetName,f);return E.metadata=u,E}return null}function d(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[s.INJECT_TAG],multiInject:t[s.MULTI_INJECT_TAG],targetName:t[s.NAME_TAG],unmanaged:t[s.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return u(e,a.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var i=Object.getPrototypeOf(n.prototype).constructor;if(i!==Object){var r=u(t,a.getFunctionName(i),i,!0),o=r.map((function(e){return e.metadata.filter((function(e){return e.key===s.UNMANAGED_TAG}))})),c=[].concat.apply([],o).length,h=r.length-c;return h>0?h:e(t,i)}return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),r=function(){function e(e,t,n,r,o){this.id=i.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(r)?r:[r],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();t.Request=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(6),o=n(24),s=n(13),a=n(50),c=function(e,t,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(i.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):n}},u=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,o=t.childRequests,h=t.target&&t.target.isArray(),d=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(h&&d)return o.map((function(t){return u(e)(t)}));var l=null;if(!t.target.isOptional()||0!==n.length){var f=n[0],_=f.scope===r.BindingScopeEnum.Singleton,p=f.scope===r.BindingScopeEnum.Request;if(_&&f.activated)return f.cache;if(p&&null!==e&&e.has(f.id))return e.get(f.id);if(f.type===r.BindingTypeEnum.ConstantValue)l=f.cache;else if(f.type===r.BindingTypeEnum.Function)l=f.cache;else if(f.type===r.BindingTypeEnum.Constructor)l=f.implementationType;else if(f.type===r.BindingTypeEnum.DynamicValue&&null!==f.dynamicValue)l=c("toDynamicValue",f.serviceIdentifier,(function(){return f.dynamicValue(t.parentContext)}));else if(f.type===r.BindingTypeEnum.Factory&&null!==f.factory)l=c("toFactory",f.serviceIdentifier,(function(){return f.factory(t.parentContext)}));else if(f.type===r.BindingTypeEnum.Provider&&null!==f.provider)l=c("toProvider",f.serviceIdentifier,(function(){return f.provider(t.parentContext)}));else{if(f.type!==r.BindingTypeEnum.Instance||null===f.implementationType){var E=s.getServiceIdentifierAsString(t.serviceIdentifier);throw new Error(i.INVALID_BINDING_TYPE+" "+E)}l=a.resolveInstance(f.implementationType,o,u(e))}return"function"==typeof f.onActivation&&(l=f.onActivation(t.parentContext,l)),_&&(f.cache=l,f.activated=!0),p&&null!==e&&!e.has(f.id)&&e.set(f.id,l),l}}};t.resolve=function(e){return u(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(6),o=n(1);t.resolveInstance=function(e,t,n){var s,a,c=null;if(t.length>0){var u=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ConstructorArgument})).map(n);a=u,c=function(e,t,n){var i=t.filter((function(e){return null!==e.target&&e.target.type===r.TargetTypeEnum.ClassProperty})),o=i.map(n);return i.forEach((function(t,n){var i;i=t.target.name.value();var r=o[n];e[i]=r})),e}(c=new((s=e).bind.apply(s,[void 0].concat(a))),t,n)}else c=new e;return function(e,t){if(Reflect.hasMetadata(o.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(o.POST_CONSTRUCT,e);try{t[n.value]()}catch(t){throw new Error(i.POST_CONSTRUCT_ERROR(e.name,t.message))}}}(e,c),c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(6),o=n(52),s=n(27),a=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=r.BindingTypeEnum.Instance,this._binding.implementationType=e,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+i.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=r.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new s.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=r.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=r.BindingTypeEnum.Constructor,this._binding.implementationType=e,new s.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=e,new s.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(i.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=r.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=r.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new s.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=r.BindingTypeEnum.Provider,this._binding.provider=e,new s.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(53),r=n(16),o=n(17),s=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding),this._bindingInSyntax=new i.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),r=n(27),o=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=i.BindingScopeEnum.Request,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=i.BindingScopeEnum.Singleton,new r.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=i.BindingScopeEnum.Transient,new r.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.of=function(t,n){var i=new e;return i.bindings=t,i.middleware=n,i},e}();t.ContainerSnapshot=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(i.NULL_ARGUMENT);if(null==t)throw new Error(i.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(i.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(i.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,i){var r=n.filter((function(t){return!e(t)}));r.length>0?t._map.set(i,r):t._map.delete(i)}))},e.prototype.hasKey=function(e){if(null==e)throw new Error(i.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(10),r=function(e){this.id=i.id(),this.registry=e};t.ContainerModule=r;var o=function(e){this.id=i.id(),this.registry=e};t.AsyncContainerModule=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(1);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(r.PARAM_TYPES,e))throw new Error(i.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(r.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(r.PARAM_TYPES,t,e),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(8);t.tagged=function(e,t){return function(n,o,s){var a=new i.Metadata(e,t);"number"==typeof s?r.tagParameter(n,o,s,a):r.tagProperty(n,o,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(8);t.named=function(e){return function(t,n,s){var a=new r.Metadata(i.NAMED_TAG,e);"number"==typeof s?o.tagParameter(t,n,s,a):o.tagProperty(t,n,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(8);t.optional=function(){return function(e,t,n){var s=new r.Metadata(i.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(e,t,n,s):o.tagProperty(e,t,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(8);t.unmanaged=function(){return function(e,t,n){var s=new r.Metadata(i.UNMANAGED_TAG,!0);o.tagParameter(e,t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(8);t.multiInject=function(e){return function(t,n,s){var a=new r.Metadata(i.MULTI_INJECT_TAG,e);"number"==typeof s?o.tagParameter(t,n,s,a):o.tagProperty(t,n,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),r=n(4),o=n(8);t.targetName=function(e){return function(t,n,s){var a=new r.Metadata(i.NAME_TAG,e);o.tagParameter(t,n,s,a)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(1),o=n(4);t.postConstruct=function(){return function(e,t,n){var s=new o.Metadata(r.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(r.POST_CONSTRUCT,e.constructor))throw new Error(i.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(r.POST_CONSTRUCT,s,e.constructor)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(67);class r extends i.InternalDispatcherException{}t.InternalDispatcherListenerIsNotRegisteredException=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{}t.InternalDispatcherException=i},function(e,t){function n(e,t){var n=[],i=[];return null==t&&(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(t)).join(".")+"]"}),function(r,o){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?i.splice(s,1/0,r):i.push(r),~n.indexOf(o)&&(o=t.call(this,r,o))}else n.push(o);return null==e?o:e.call(this,r,o)}}(e.exports=function(e,t,i,r){return JSON.stringify(e,n(t,r),i)}).getSerialize=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ON_TAB_CREATED="ON_TAB_CREATED",e.ON_TAB_UPDATED="ON_TAB_UPDATED",e.ON_TAB_MOVED="ON_TAB_MOVED",e.ON_TAB_ACTIVATED="ON_TAB_ACTIVATED",e.ON_TAB_HIGHLIGHTED="ON_TAB_HIGHLIGHTED",e.ON_TAB_DETACHED="ON_TAB_DETACHED",e.ON_TAB_ATTACHED="ON_TAB_ATTACHED",e.ON_TAB_REMOVED="ON_TAB_REMOVED",e.ON_TAB_REPLACED="ON_TAB_REPLACED",e.ON_TAB_ZOOM_CHANGE="ON_TAB_ZOOM_CHANGE"}(t.TabServiceEvents||(t.TabServiceEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(71);class r extends i.CoreException{}t.CoreServiceIsNotRegisteredException=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{}t.CoreException=i},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),a=(n(73),n(5));let c=class{constructor(e){this.browserEnum=e,this.isOnInstalledFired=!1,this.listeners=[],chrome.runtime.onInstalled.addListener(e=>{this.isOnInstalledFired=!0,this.installedDetails=e,this.handleOnInstall()})}onInstall(e){this.listeners.push({callback:e}),this.isOnInstalledFired&&this.handleOnInstall()}setUninstallURL(e,t){chrome.runtime.setUninstallURL(e,t)}manifest(){return chrome.runtime.getManifest()}browser(){return this.browserEnum}handleOnInstall(){for(const e of this.listeners)e.callback(this.installedDetails);this.listeners=[]}};c=i([s.injectable(),o(0,s.inject(a.MARIO_TYPES.BROWSER)),r("design:paramtypes",[String])],c),t.Extension=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.CHROME_BROWSER="CHROME_BROWSER",e.FIREFOX_BROWSER="FIREFOX_BROWSER",e.EDGE_BROWSER="EDGE_BROWSER",e.SAFARI_BROWSER="SAFARI_BROWSER",e.OPERA_BROWSER="OPERA_BROWSER",e.CHROMIUM_BROWSER="CHROMIUM_BROWSER"}(t.BrowserEnum||(t.BrowserEnum={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(75);class r extends i.ExternalDispatcherException{}t.ExternalDispatcherListenerIsNotFoundException=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{}t.ExternalDispatcherException=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MarioModule=class{constructor(e){this._core=e}mario(){return this._core}}},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(t){if(!t)throw new TypeError("Invalid argument; `value` has no value.");this.value=e.EMPTY,t&&e.isGuid(t)&&(this.value=t)}return e.isGuid=function(t){var n=t.toString();return t&&(t instanceof e||e.validator.test(n))},e.create=function(){return new e([e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-"))},e.createEmpty=function(){return new e("emptyguid")},e.parse=function(t){return new e(t)},e.raw=function(){return[e.gen(2),e.gen(1),e.gen(1),e.gen(1),e.gen(3)].join("-")},e.gen=function(e){for(var t="",n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t},e.prototype.equals=function(t){return e.isGuid(t)&&this.value===t.toString()},e.prototype.isEmpty=function(){return this.value===e.EMPTY},e.prototype.toString=function(){return this.value},e.prototype.toJSON=function(){return{value:this.value}},e.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),e.EMPTY="00000000-0000-0000-0000-000000000000",e}();t.Guid=i},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(33),u=n(5),h=n(79);let d=class{constructor(e,t){this.logger=e,this.dispatcher=t}clear(){return s(this,void 0,void 0,(function*(){yield this.dispatcher.emit(new c.MarioEvent(h.CacheEvents.BEFORE_CLEAR_CACHE)),yield this.cacheRemoveAll(),yield this.dispatcher.emit(new c.MarioEvent(h.CacheEvents.AFTER_CLEAR_CACHE))}))}cacheRemoveAll(){return s(this,void 0,void 0,(function*(){return new Promise((e,t)=>{try{chrome.browsingData.removeCache({},()=>{e()})}catch(e){this.logger.error(e),t()}})}))}};d.EVENT_BEFORE_CLEAR_CACHE="beforeClearCache",d.EVENT_AFTER_CLEAR_CACHE="afterClearCache",d=i([a.injectable(),o(0,a.inject(u.MARIO_TYPES.LOGGER_SERVICE)),o(1,a.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object,Object])],d),t.CacheService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BEFORE_CLEAR_CACHE="BEFORE_CLEAR_CACHE",e.AFTER_CLEAR_CACHE="AFTER_CLEAR_CACHE"}(t.CacheEvents||(t.CacheEvents={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContentDispatcherService=class{constructor(){this.listeners={},this.listenersIndex={},this.counter=0,chrome.runtime.onMessage.addListener(e=>{if(!this.isEventMessage(e))return;if(!this.hasEventListeners(e.event))return void console.log("ContentDispatcherService: no listeners for an event "+e.event);const t=[],n=this.listeners[e.event];for(const i of Object.keys(n)){const r=(0,n[i])(e);t.push(r)}return Promise.all(t).then(),!1})}emit(e,t){chrome.runtime.sendMessage(e,t)}on(e,t){const n=++this.counter;return this.hasEventListeners(e)||(this.listeners[e]={}),this.listeners[e][n]=t,this.listenersIndex[n]=e,n}hasEventListeners(e){return void 0!==this.listeners[e]}removeListener(e){if(this.hasListener(e)){const t=this.listenersIndex[e];delete this.listeners[t][e],delete this.listenersIndex[e]}}hasListener(e){return this.listenersIndex.hasOwnProperty(e)}getListener(e){if(!this.hasListener(e))throw new Error("boom");const t=this.listenersIndex[e];return this.listeners[t][e]}isEventMessage(e){return"object"==typeof e&&"string"==typeof e.event}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(7),u=n(5),h=n(82);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnBeforeNavigate=!1,this.isListenOnCommitted=!1,this.isListenOnDOMContentLoaded=!1,this.isListenOnCompleted=!1,this.isListenOnErrorOccurred=!1,this.isListenOnCreatedNavigationTarget=!1,this.isListenOnReferenceFragmentUpdated=!1,this.isListenOnTabReplaced=!1,this.isListenOnHistoryStateUpdated=!1}listenOnBeforeNavigate(){this.isListenOnBeforeNavigate||(this.isListenOnBeforeNavigate=!0,chrome.webNavigation.onBeforeNavigate.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_BEFORE_NAVIGATE,{details:e});this.dispatcherService.emit(t).then()}))}listenOnCommitted(){this.isListenOnCommitted||(this.isListenOnCommitted=!0,chrome.webNavigation.onCommitted.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_COMMITTED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnDOMContentLoaded(){this.isListenOnDOMContentLoaded||(this.isListenOnDOMContentLoaded=!0,chrome.webNavigation.onDOMContentLoaded.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_DOM_CONTENT_LOADED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnCompleted(){this.isListenOnCompleted||(this.isListenOnCompleted=!0,chrome.webNavigation.onCompleted.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_COMPLETED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnErrorOccurred(){this.isListenOnErrorOccurred||(this.isListenOnErrorOccurred=!0,chrome.webNavigation.onErrorOccurred.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_ERROR_OCCURRED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnCreatedNavigationTarget(){this.isListenOnCreatedNavigationTarget||(this.isListenOnCreatedNavigationTarget=!0,chrome.webNavigation.onCreatedNavigationTarget.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_CREATED_NAVIGATION_TARGET,{details:e});this.dispatcherService.emit(t).then()}))}listenOnReferenceFragmentUpdated(){this.isListenOnReferenceFragmentUpdated||(this.isListenOnReferenceFragmentUpdated=!0,chrome.webNavigation.onReferenceFragmentUpdated.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnTabReplaced(){this.isListenOnTabReplaced||(this.isListenOnTabReplaced=!0,chrome.webNavigation.onTabReplaced.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_TAB_REPLACED,{details:e});this.dispatcherService.emit(t).then()}))}listenOnHistoryStateUpdated(){this.isListenOnHistoryStateUpdated||(this.isListenOnHistoryStateUpdated=!0,chrome.webNavigation.onHistoryStateUpdated.addListener(e=>{const t=new c.MarioEvent(h.NavigationServiceEvents.NAVIGATION_ON_HISTORY_STATE_UPDATED,{details:e});this.dispatcherService.emit(t).then()}))}getFrame(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.webNavigation.getFrame(e,e=>t(e))}catch(e){n(e)}})}))}getAllFrames(e){return s(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.webNavigation.getAllFrames(e,e=>t(e))}catch(e){n(e)}})}))}};d=i([a.injectable(),o(0,a.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.NavigationService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NAVIGATION_ON_BEFORE_NAVIGATE="NAVIGATION_ON_BEFORE_NAVIGATE",e.NAVIGATION_ON_COMMITTED="NAVIGATION_ON_COMMITTED",e.NAVIGATION_ON_DOM_CONTENT_LOADED="NAVIGATION_ON_DOM_CONTENT_LOADED",e.NAVIGATION_ON_COMPLETED="NAVIGATION_ON_COMPLETED",e.NAVIGATION_ON_ERROR_OCCURRED="NAVIGATION_ON_ERROR_OCCURRED",e.NAVIGATION_ON_CREATED_NAVIGATION_TARGET="NAVIGATION_ON_CREATED_NAVIGATION_TARGET",e.NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED="NAVIGATION_ON_REFERENCE_FRAGMNENT_UPDATED",e.NAVIGATION_ON_TAB_REPLACED="NAVIGATION_ON_TAB_REMOVED",e.NAVIGATION_ON_HISTORY_STATE_UPDATED="NAVIGATION_ON_HISTORY_STATE_UPDATED"}(t.NavigationServiceEvents||(t.NavigationServiceEvents={}))},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(7),u=n(5),h=n(84);let d=class{constructor(e){this.dispatcherService=e,this.isListenOnBeforeRequest=!1,this.isListenOnBeforeSendHeaders=!1,this.isListenOnSendHeaders=!1,this.isListenOnHeadersReceived=!1,this.isListenOnAuthRequired=!1,this.isListenOnResponseStarted=!1,this.isListenOnBeforeRedirect=!1,this.isListenOnCompleted=!1,this.isListenOnErrorOccurred=!1,this.isListenOnActionIgnored=!1}listenOnBeforeRequest(e,t){this.isListenOnBeforeRequest||(this.isListenOnBeforeRequest=!0,chrome.webRequest.onBeforeRequest.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REQUEST,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnBeforeSendHeaders(e,t){this.isListenOnBeforeSendHeaders||(this.isListenOnBeforeSendHeaders=!0,chrome.webRequest.onBeforeSendHeaders.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_SEND_HEADERS,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnSendHeaders(e,t){this.isListenOnSendHeaders||(this.isListenOnSendHeaders=!0,chrome.webRequest.onSendHeaders.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_SEND_HEADERS,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnHeadersReceived(e,t){this.isListenOnHeadersReceived||(this.isListenOnHeadersReceived=!0,chrome.webRequest.onHeadersReceived.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_HEADERS_RECEIVED,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnAuthRequired(e,t){this.isListenOnAuthRequired||(this.isListenOnAuthRequired=!0,chrome.webRequest.onAuthRequired.addListener((e,t)=>{const n=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_AUTH_REQUIRED,{details:e,callback:t});this.dispatcherService.emit(n).then()},e,t))}listenOnResponseStarted(e,t){this.isListenOnResponseStarted||(this.isListenOnResponseStarted=!0,chrome.webRequest.onResponseStarted.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_RESPONSE_STARTED,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnBeforeRedirect(e,t){this.isListenOnBeforeRedirect||(this.isListenOnBeforeRedirect=!0,chrome.webRequest.onBeforeRedirect.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_BEFORE_REDIRECT,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnCompleted(e,t){this.isListenOnCompleted||(this.isListenOnCompleted=!0,chrome.webRequest.onCompleted.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_COMPLETED,{details:e});this.dispatcherService.emit(t).then()},e,t))}listenOnErrorOccurred(e){this.isListenOnErrorOccurred||(this.isListenOnErrorOccurred=!0,chrome.webRequest.onErrorOccurred.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_ERROR_OCCURRED,{details:e});this.dispatcherService.emit(t).then()},e))}listenOnActionIgnored(e,t){this.isListenOnActionIgnored||(this.isListenOnActionIgnored=!0,chrome.webRequest.onActionIgnored.addListener(e=>{const t=new c.MarioEvent(h.WebRequestServiceEvents.WEB_REQUEST_ON_ACTION_IGNORED,{details:e});this.dispatcherService.emit(t).then()},e,t))}handlerBehaviorChanged(){return s(this,void 0,void 0,(function*(){return new Promise((e,t)=>{try{chrome.webRequest.handlerBehaviorChanged(()=>e())}catch(e){t(e)}})}))}};d=i([a.injectable(),o(0,a.inject(u.MARIO_TYPES.INTERNAL_DISPATCHER)),r("design:paramtypes",[Object])],d),t.WebRequestService=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.WEB_REQUEST_ON_BEFORE_REQUEST="WEB_REQUEST_ON_BEFORE_REQUEST",e.WEB_REQUEST_ON_BEFORE_SEND_HEADERS="WEB_REQUEST_ON_BEFORE_SEND_HEADERS",e.WEB_REQUEST_ON_SEND_HEADERS="WEB_REQUEST_ON_SEND_HEADERS",e.WEB_REQUEST_ON_HEADERS_RECEIVED="WEB_REQUEST_ON_HEADERS_RECEIVED",e.WEB_REQUEST_ON_AUTH_REQUIRED="WEB_REQUEST_ON_AUTH_REQUIRED",e.WEB_REQUEST_ON_RESPONSE_STARTED="WEB_REQUEST_ON_RESPONSE_STARTED",e.WEB_REQUEST_ON_BEFORE_REDIRECT="WEB_REQUEST_ON_BEFORE_REDIRECT",e.WEB_REQUEST_ON_COMPLETED="WEB_REQUEST_ON_COMPLETED",e.WEB_REQUEST_ON_ERROR_OCCURRED="WEB_REQUEST_ON_ERROR_OCCURRED",e.WEB_REQUEST_ON_ACTION_IGNORED="WEB_REQUEST_ON_ACTION_IGNORED"}(t.WebRequestServiceEvents||(t.WebRequestServiceEvents={}))},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2);let s=class{get(e){return r(this,void 0,void 0,(function*(){return new Promise((t,n)=>{chrome.storage.local.get(e,n=>{const i=void 0!==n[e]?n[e]:null;t(i)})})}))}set(e,t){return r(this,void 0,void 0,(function*(){return new Promise((n,i)=>{const r={};r[e]=t,chrome.storage.local.set(r,()=>n())})}))}has(e){return r(this,void 0,void 0,(function*(){return null!==(yield this.get(e))}))}remove(e){return r(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{chrome.storage.local.remove(e,()=>t())}catch(e){n(e)}})}))}clean(){chrome.storage.local.clear()}};s=i([o.injectable()],s),t.StorageService=s},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(2),a=n(7),c=n(37),u=n(20),h=n(18),d=n(21);let l=class{constructor(e,t){this.portDispatcher=e,this.state=t,this.events=[]}send(e){this.events.push(e),this.state.isNotReady()&&this.portDispatcher.hasNotPort(c.PortsList.MARIO_DEVTOOLS)||(this.events.forEach(e=>{setTimeout(()=>{this.portDispatcher.hasPort(c.PortsList.MARIO_DEVTOOLS)&&this.portDispatcher.emit(e,c.PortsList.MARIO_DEVTOOLS,!0)},0)}),this.events=[])}};l=i([s.injectable(),o(0,s.inject(a.MARIO_TYPES.PORT_DISPATCHER)),o(1,s.inject(h.DevToolsTypes.DEV_TOOLS_STATE)),r("design:paramtypes",[u.PortDispatcher,d.DevToolsState])],l),t.DevToolsEmitter=l},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(7);let u=class{constructor(e){this.storage=e}getConfig(){return s(this,void 0,void 0,(function*(){if(yield this.storage.has("DEV_TOOLS_CONFIG")){const e=yield this.storage.get("DEV_TOOLS_CONFIG");return JSON.parse(e)}return{externalEventsIn:{enabled:!0,filter:[],includeMode:!0,indexes:[],options:[]},externalEventsOut:{enabled:!0,filter:[],includeMode:!0,indexes:[],options:[]},internalEvents:{enabled:!0,filter:[],includeMode:!0,indexes:[],options:[]},portEventsIn:{enabled:!0,filter:[],includeMode:!0,indexes:[],options:[]},portEventsOut:{enabled:!0,filter:[],includeMode:!0,indexes:[],options:[]},logInfo:{enabled:!0,indexes:[]},logWarn:{enabled:!0,indexes:[]},logError:{enabled:!0,indexes:[]}}}))}storeConfig(e){return s(this,void 0,void 0,(function*(){yield this.storage.set("DEV_TOOLS_CONFIG",JSON.stringify(e))}))}};u=i([a.injectable(),o(0,a.inject(c.MARIO_TYPES.STORAGE_SERVICE)),r("design:paramtypes",[Object])],u),t.DevToolsStorage=u},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(121),r=n(122),o=n(123),s=n(124),a=n(86),c=n(18),u=n(87),h=n(21),d=n(125),l=n(126),f=n(127);mario.registerService(c.DevToolsTypes.DEV_TOOLS_STATE,h.DevToolsState),mario.registerService(c.DevToolsTypes.DEV_TOOLS_STORAGE,u.DevToolsStorage),mario.registerService(c.DevToolsTypes.DEV_TOOLS_EMITTER_SERVICE,a.DevToolsEmitter);const _=mario.getService(c.DevToolsTypes.DEV_TOOLS_EMITTER_SERVICE),p=new r.EventsFactory,E=new o.ItemsFactory;mario.externalDispatcher().on(i.ExternalAnyEventListener),mario.portDispatcher().on(s.PortAnyEventListener),mario.portDispatcher().on(d.GetDevToolsConfigListener),mario.portDispatcher().on(l.DevToolsReadyListener),mario.portDispatcher().on(f.SaveDevToolsConfigListener),mario.logger().onLog((e,t)=>{const n=E.buildLoggerInfo(e,t),i=p.buildLoggerInfo(n);_.send(i)}),mario.logger().onWarn((e,t)=>{const n=E.buildLoggerWarn(e,t),i=p.buildLoggerWarn(n);_.send(i)}),mario.logger().onError(e=>{const t=E.buildLoggerError(e),n=p.buildLoggerError(t);_.send(n)}),mario.externalDispatcher().onBeforeEmit((e,t)=>{const n=E.buildExternalEventOut(t.event,t.data),i=p.buildExternalEventOut(n);_.send(i)}),mario.internalDispatcher().onBeforeEmit(e=>{const t=E.buildInternalEvent(e.event,e.data),n=p.buildInternalEvent(t);_.send(n)}),mario.portDispatcher().onBeforeEmit(e=>{const t=E.buildPortOutEvent(e.event,e.data),n=p.buildPortEventOut(t);_.send(n)})},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(35),c=n(2),u=n(12),h=n(0),d=n(86),l=n(18),f=n(21);let _=class{constructor(e,t){this.emitter=e,this.state=t}on(){return a.ExternalDispatcherEvents.ON_ANY_MESSAGE}handle(e,t,n){var i,r,o,a,c;return s(this,void 0,void 0,(function*(){const n=e,s={data:{data:{args:e.event?e.data:e,event:e.event?e.event:(null===(i=n)||void 0===i?void 0:i.type)?n.type:"NO_NAME",tabId:null===(o=null===(r=t)||void 0===r?void 0:r.tab)||void 0===o?void 0:o.id,title:null===(c=null===(a=t)||void 0===a?void 0:a.tab)||void 0===c?void 0:c.title},show:!0,type:h.ITEM_TYPE.EVENT_EXTERNAL_IN},event:u.DevtoolsEvents.MARIO_DEVTOOLS_EXTERNAL_IN_EVENT,id:"asdfasdf"};this.emitter.send(s)}))}};_=i([c.injectable(),o(0,c.inject(l.DevToolsTypes.DEV_TOOLS_EMITTER_SERVICE)),o(1,c.inject(l.DevToolsTypes.DEV_TOOLS_STATE)),r("design:paramtypes",[d.DevToolsEmitter,f.DevToolsState])],_),t.ExternalAnyEventListener=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(12);t.EventsFactory=class{build(e,t){return{data:t,event:e,id:"random ID"}}buildLoggerInfo(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_LOGGER_INFO,e)}buildLoggerWarn(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_LOGGER_WARN,e)}buildLoggerError(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_LOGGER_ERROR,e)}buildExternalEventOut(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_EXTERNAL_OUT_EVENT,e)}buildPortEventOut(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_PORT_OUT_EVENT,e)}buildInternalEvent(e){return this.build(i.DevtoolsEvents.MARIO_DEVTOOLS_INTERNAL_EVENT,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(0);t.ItemsFactory=class{build(e,t){return{type:e,data:t,show:!0}}buildLoggerInfo(e,t){return this.build(i.ITEM_TYPE.LOG_INFO,{args:t,text:e})}buildLoggerWarn(e,t){return this.build(i.ITEM_TYPE.LOG_WARN,{args:t,text:e})}buildLoggerError(e){return this.build(i.ITEM_TYPE.LOG_ERROR,{args:e.stack,text:e.message})}buildExternalEventOut(e,t){return this.build(i.ITEM_TYPE.EVENT_EXTERNAL_OUT,{args:t,event:e})}buildInternalEvent(e,t){return this.build(i.ITEM_TYPE.EVENT_INTERNAL,{args:t,event:e})}buildPortOutEvent(e,t){return this.build(i.ITEM_TYPE.EVENT_PORT_OUT,{args:t,event:e})}}},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(36),c=n(2),u=n(0),h=n(12),d=n(18),l=n(86);let f=class{constructor(e){this.emitter=e}on(){return a.PortDispatcherEvents.ON_ANY_MESSAGE}handle(e){return s(this,void 0,void 0,(function*(){const t={data:{data:{args:e.event?e.data:e,event:e.event?e.event:"NO_NAME"},show:!0,type:u.ITEM_TYPE.EVENT_PORT_IN},event:h.DevtoolsEvents.MARIO_DEVTOOLS_PORT_IN_EVENT,id:"asdfasdf"};this.emitter.send(t)}))}};f=i([c.injectable(),o(0,c.inject(d.DevToolsTypes.DEV_TOOLS_EMITTER_SERVICE)),r("design:paramtypes",[l.DevToolsEmitter])],f),t.PortAnyEventListener=f},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(18),u=n(21),h=n(87),d=n(20),l=n(7);let f=class{constructor(e,t,n){this.state=e,this.store=t,this.dispatcher=n}on(){return"GetDevToolsConfig"}handle(e){return s(this,void 0,void 0,(function*(){const e=yield this.store.getConfig(),t=new l.MarioEvent("GetDevToolsConfigResponse",e);setTimeout(()=>this.dispatcher.emit(t),0)}))}};f=i([a.injectable(),o(0,a.inject(c.DevToolsTypes.DEV_TOOLS_STATE)),o(1,a.inject(c.DevToolsTypes.DEV_TOOLS_STORAGE)),o(2,a.inject(l.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[u.DevToolsState,h.DevToolsStorage,d.PortDispatcher])],f),t.GetDevToolsConfigListener=f},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(18),u=n(21);let h=class{constructor(e){this.state=e}on(){return"DevToolsReady"}handle(e){return s(this,void 0,void 0,(function*(){this.state.setReady()}))}};h=i([a.injectable(),o(0,a.inject(c.DevToolsTypes.DEV_TOOLS_STATE)),r("design:paramtypes",[u.DevToolsState])],h),t.DevToolsReadyListener=h},function(e,t,n){"use strict";var i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),c=n(18),u=n(21),h=n(87),d=n(20),l=n(7);let f=class{constructor(e,t,n){this.state=e,this.store=t,this.dispatcher=n}on(){return"SaveDevToolsConfig"}handle(e){return s(this,void 0,void 0,(function*(){const t=e.data;yield this.store.storeConfig(t)}))}};f=i([a.injectable(),o(0,a.inject(c.DevToolsTypes.DEV_TOOLS_STATE)),o(1,a.inject(c.DevToolsTypes.DEV_TOOLS_STORAGE)),o(2,a.inject(l.MARIO_TYPES.PORT_DISPATCHER)),r("design:paramtypes",[u.DevToolsState,h.DevToolsStorage,d.PortDispatcher])],f),t.SaveDevToolsConfigListener=f}]);